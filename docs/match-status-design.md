# 試合ステータス設計

## 概要

試合の延期・中止等の例外処理に対応するための設計です。

## ステータス定義

| ステータス | 英語名 | 説明 |
|------------|--------|------|
| scheduled | 予定 | 開催予定の試合 |
| finished | 終了 | 試合終了（結果確定） |
| postponed | 延期 | 開催延期（日程未定） |
| rescheduled | 振替 | 振替試合（新日程確定） |
| cancelled | 中止 | 開催中止 |

## データベース変更

### matchesテーブル

```sql
ALTER TABLE matches ADD COLUMN status VARCHAR(16) DEFAULT 'scheduled';
```

### ステータス遷移

```
scheduled → finished (通常)
scheduled → postponed (延期発表)
postponed → rescheduled (新日程発表)
rescheduled → finished (振替試合終了)
scheduled → cancelled (中止発表)
```

## 集計ルール

### 観戦数カウント

| ステータス | カウント |
|------------|----------|
| finished | する |
| postponed | しない |
| rescheduled | しない（振替後のfinishedでカウント） |
| cancelled | しない |

### 費用集計

| ステータス | 集計 |
|------------|------|
| finished | する |
| postponed | する（実際に発生した費用は記録） |
| cancelled | する（実際に発生した費用は記録） |

### 戦績集計

| ステータス | 勝敗判定 |
|------------|----------|
| finished | スコアから判定 |
| その他 | 対象外 |

## UI表示

### 試合一覧

- **postponed**: 「延期」バッジ（オレンジ）
- **cancelled**: 「中止」バッジ（グレー）
- **rescheduled**: 「振替」バッジ + 新日程表示

### 観戦記録

延期/中止でも観戦記録は残せる（実際に会場に行った場合）

```
「この試合は延期となりましたが、記録を残しますか？」
[記録する] [キャンセル]
```

## 実装タスク

1. [ ] matchesテーブルにstatusカラム追加
2. [ ] スクレイパーでステータス取得対応
3. [ ] 集計ロジックでステータスフィルタ追加
4. [ ] UIにステータスバッジ表示

## 注意事項

- 延期/中止情報はスクレイピング元に依存
- 手動での変更も可能にしておく
- 振替試合は別レコードとして扱う

## 更新履歴

- 2026-01-01: 初版作成
